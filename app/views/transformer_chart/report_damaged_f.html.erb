<link rel="stylesheet" type="text/css" href="/stylesheets/jquery.jqplot.css" />
  <link rel="stylesheet" type="text/css" href="/stylesheets/examples.css" />
  <!--[if lt IE 9]><script language="javascript" type="text/javascript" src="/javascripts/excanvas.js"></script><![endif]-->
  
  <!-- BEGIN: load jquery -->
  <script language="javascript" type="text/javascript" src="/javascripts/jquery.js"></script>
 
  <!-- END: load jquery -->
  
  <!-- BEGIN: load jqplot -->
  <script language="javascript" type="text/javascript" src="/javascripts/jquery.jqplot.js"></script>
	<script language="javascript" type="text/javascript" src="/javascripts/jqplot.logAxisRenderer.js"></script>
	<script language="javascript" type="text/javascript" src="/javascripts/jqplot.canvasTextRenderer.js"></script>
	<script language="javascript" type="text/javascript" src="/javascripts/jqplot.canvasAxisLabelRenderer.js"></script>
	<script language="javascript" type="text/javascript" src="/javascripts/jqplot.canvasAxisTickRenderer.js"></script>
	<script language="javascript" type="text/javascript" src="/javascripts/jqplot.dateAxisRenderer.js"></script>
	<script language="javascript" type="text/javascript" src="/javascripts/jqplot.categoryAxisRenderer.js"></script>
	<script language="javascript" type="text/javascript" src="/javascripts/jqplot.barRenderer.js"></script>
	<script language="javascript" type="text/javascript" src="/javascripts/jqplot.pieRenderer.js"></script>
	<script language="javascript" type="text/javascript" src="/javascripts/jqplot.pointLabels.js"></script>
	
	
	
<style type="text/css">
	.jqplot-point-label {white-space: nowrap;}
	/*.jqplot-yaxis-label {font-size: 14pt;}*/
	/*.jqplot-yaxis-tick {font-size: 7pt;}*/
	.jqplot { margin: 30px 30px 60px 50px;}
	/*.jqplot-xaxis { margin-top: 10px;}
	.jqplot-xaxis-tick {padding-top: 0px;}
	.jqplot-yaxis {margin-right: 10px;}
	.jqplot-yaxis-tick {padding-right: 0px;}*/
</style>

<script class="code" type="text/javascript" language="javascript">
$(document).ready(function(){
      $.jqplot.config.enablePlugins = true;
 

<%if params[:chart] == "2" and params[:unit] == "2"%>
  line1 = [['Cup Holder Pinion Bob',(7*100/(7+9+15+12+3))], ['Generic Fog Lamp',(9*100/(7+9+15+12+3))], ['HDTV Receiver',(15*100/(7+9+15+12+3))], ['8 Track Control Module',(12*100/(7+9+15+12+3))], [' Sludge Pump Fourier Modulator', (3*100/(7+9+15+12+3))]];
  bar1 = $.jqplot('chart', [line1], {
    title: '<%=@titles%>',
    series:[{renderer:$.jqplot.BarRenderer}],
	 seriesDefaults:{
               renderer:$.jqplot.BarRenderer, 
               shadow:true
             },
    axes: {
      xaxis: {
        renderer: $.jqplot.CategoryAxisRenderer,
          label: 'Warranty Concern',
        //labelRenderer: $.jqplot.CanvasAxisLabelRenderer,
        tickRenderer: $.jqplot.CanvasAxisTickRenderer,
        tickOptions: {
          enableFontSupport: true,
            angle: 30
        }
        
      },
      yaxis: {
        autoscale:true,
          label: 'Occurance',
        labelRenderer: $.jqplot.CanvasAxisLabelRenderer,
        tickRenderer: $.jqplot.CanvasAxisTickRenderer,
			ticks:[0,20,40,60,80,100], 
        tickOptions: {
          formatString:'%.1f\%',
          enableFontSupport: true
        }
      }
    }
  });
<% elsif params[:chart] == "2" and params[:unit] == "1" %>
  line2 = [['Cup Holder Pinion Bob', 7], ['Generic Fog Lamp', 9], ['HDTV Receiver', 15], ['8 Track Control Module', 12],[' Sludge Pump Fourier Modulator', 3]];
  bar2 = $.jqplot('chart', [line2], {
    title: '<%=@titles%>',
     series:[{renderer:$.jqplot.BarRenderer}],
	 seriesDefaults:{
               renderer:$.jqplot.BarRenderer, 
               shadow:true
             },
    axes: {
      xaxis: {
        renderer: $.jqplot.CategoryAxisRenderer,
          label: 'Warranty Concern',
        // labelRenderer: $.jqplot.CanvasAxisLabelRenderer,
        tickRenderer: $.jqplot.CanvasAxisTickRenderer,
        tickOptions: {
          enableFontSupport: true,
            angle: 30
        }
        
      },
      yaxis: {
        autoscale:true,
          label: 'Occurance',
        labelRenderer: $.jqplot.CanvasAxisLabelRenderer,
        tickRenderer: $.jqplot.CanvasAxisTickRenderer,
        tickOptions: {
          enableFontSupport: true
        }
      }
    }
  });

<% elsif params[:chart] == "1" and params[:unit] == "2" %>
  line3 = [['Cup Holder Pinion Bob',(7*100/(7+9+15+12+3))], ['Generic Fog Lamp',(9*100/(7+9+15+12+3))], ['HDTV Receiver',(15*100/(7+9+15+12+3))], ['8 Track Control Module',(12*100/(7+9+15+12+3))], [' Sludge Pump Fourier Modulator', (3*100/(7+9+15+12+3))]];
  plot3 = $.jqplot('chart', [line3], {
	  title: '<%=@titles%>',
	  legend: { show: true, placement: 'outside',  rendererOptions:{numberColumns:3}},
        seriesDefaults: {
            renderer:$.jqplot.PieRenderer
        }
    });

$('#chart').bind('jqplotDataHighlight', 
        function (ev, seriesIndex, pointIndex, data) {
				var a = ""+data;
				var b = a.split(",");
				var c = parseFloat(b[1]); 
            $('#info').html('series: <font color="#0000ff">'+seriesIndex+'</font>, point: <font color="#0000ff">'+pointIndex+'</font>, data: <font color="#0000ff">'+b[0]+','+c.toFixed(1)+'%</font>');
        }
    );
    
    $('#chart').bind('jqplotDataUnhighlight', 
        function (ev) {
            $('#info').html('<font color="#0000ff">Nothing</font>');
        }
    ); 

<%else%>
	 line4 = [['Cup Holder Pinion Bob',7], ['Generic Fog Lamp',9], ['HDTV Receiver',15], ['8 Track Control Module',12], [' Sludge Pump Fourier Modulator', 3]];
	 plot4 = $.jqplot('chart', [line4], {
	  title: '<%=@titles%>',
	  legend: { show: true, placement: 'outside',  rendererOptions:{numberColumns:3}},
        seriesDefaults: {
            renderer:$.jqplot.PieRenderer
        }
    });

$('#chart').bind('jqplotDataHighlight', 
        function (ev, seriesIndex, pointIndex, data) {
            $('#info').html('series: <font color="#0000ff">'+seriesIndex+'</font>, point: <font color="#0000ff">'+pointIndex+'</font>, data: <font color="#0000ff">'+data+'</font>');
        }
    );
    
    $('#chart').bind('jqplotDataUnhighlight', 
        function (ev) {
            $('#info').html('<font color="#0000ff">Nothing</font>');
        }
    ); 
<% end %>

});


</script>


<h1>รายงานตามผู้ใช้งานสำหรับข้อมูลความเสียหาย</h1>

	<%if((params[:chart]==nil and params[:unit]==nil) or (params[:chart]=="1" and params[:unit]=="1") or (params[:chart]=="1" and params[:unit]=="2"))%>
		<div class='jqplot' id='chart' class='graph' style='height:300px; width:300px;'></div>
		<div><span>Moused Over: </span><span id="info"><font color="#0000ff">Nothing</font></span></div>
	<%else%>
		<div class='jqplot' id='chart' class='graph' style='height:320px; width:400px;'></div>
	<%end%>
<form name="form">
<br>
<a href="javascript:javascript: history.go(-1);"><%= submit_tag "<< Back", :class => "cupid-green" %></a>
</form>
