<div class="grid_16">
  <dl>
    <div class="grid_7">
      <dt>Transformer Name</dt>
      <dd><%= " : " + @transformer.transformer_name %></dd>
    </div>
    <div class="grid_7">
      <dt>Equipment No.</dt>
      <dd><%= " : " + @transformer.egatsn %></dd>
    </div>
  </dl>
</div>

<div class="clear"></div>

<br/>

<div class="grid_16">
  <table>
    <thead>
      <tr>
        <th colspan="3">HV Bushing</th>
        <th colspan="2">
          <%=
            min = [@bushing_test.health_index_factor("h1"), @bushing_test.health_index_factor("h2"),
                   @bushing_test.health_index_factor("h3"), @bushing_test.health_index_factor("h0")].min
            condition_color(min)
          %>
        </th>
        <tr>
          <th colspan="3">%HV Bushing Factor = </th>
          <th colspan="2">
            <%=
              max = [@bushing_test.percent_bushing_factor("h1"), @bushing_test.percent_bushing_factor("h2"),
                     @bushing_test.percent_bushing_factor("h3"), @bushing_test.percent_bushing_factor("h0")].max
              number_with_precision(max, :precision => 2)
            %>
          </th>
      </tr>
      <tr>
        <th>Bushing</th>
        <th>%Bushing Factor</th>
        <th>Health Index Factor</th>
        <th>Condition</th>
        <th>Date</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>H1</td>
        <td><%= number_with_precision(@bushing_test.percent_bushing_factor("h1"), precision: 2) %></td>
        <td><%= @bushing_test.health_index_factor("h1") %></td>
        <td><%= condition_color(@bushing_test.health_index_factor("h1")) %></td>
        <td><%= @bushing_test.thai_test_date %></td>
      </tr>
      <tr>
        <td>H2</td>
        <td><%= number_with_precision(@bushing_test.percent_bushing_factor("h2"), precision: 2) %></td>
        <td><%= @bushing_test.health_index_factor("h2") %></td>
        <td><%= condition_color(@bushing_test.health_index_factor("h2")) %></td>
        <td><%= @bushing_test.thai_test_date %></td>
      </tr>
      <tr>
        <td>H3</td>
        <td><%= number_with_precision(@bushing_test.percent_bushing_factor("h3"), precision: 2) %></td>
        <td><%= @bushing_test.health_index_factor("h3") %></td>
        <td><%= condition_color(@bushing_test.health_index_factor("h3")) %></td>
        <td><%= @bushing_test.thai_test_date %></td>
      </tr>
      <tr>
        <td>H4</td>
        <td><%= number_with_precision(@bushing_test.percent_bushing_factor("h0"), precision: 2) %></td>
        <td><%= @bushing_test.health_index_factor("h0") %></td>
        <td><%= condition_color(@bushing_test.health_index_factor("h0")) %></td>
        <td><%= @bushing_test.thai_test_date %></td>
      </tr>
    </tbody>
  </table>
</div>

<div class="clear"></div>

<br/>

<h4>กราฟแสดงความสัมพันธ์ระหว่าง %PowerFactor(C1) กับวันทดสอบ</h4>
<div id="hv_power_factor_cor_20c_graph" style="width:900px;height:400px"></div>
<button id="reset_hv_power_factor_cor_20c">Reset</button>

<br/>

<h4>กราฟแสดงความสัมพันธ์ระหว่าง %PowerFactor(C2) กับวันทดสอบ</h4>
<div id="hv_power_factor_avg_graph" style="width:900px;height:400px"></div>
<button id="reset_hv_power_factor_avg">Reset</button>

<br/>

<h4>กราฟแสดงความสัมพันธ์ระหว่าง %Capacitance(C1) กับวันทดสอบ</h4>
<div id="hv_c1_graph" style="width:900px;height:400px"></div>
<button id="reset_c1">Reset</button>

<br/>
<h4>กราฟแสดงความสัมพันธ์ระหว่าง %Capacitance(C2) กับวันทดสอบ</h4>
<div id="hv_c2_graph" style="width:900px;height:400px"></div>
<button id="reset_c2">Reset</button>

<hr/>
<br/>

<div class="grid_16">
  <table>
    <thead>
      <tr>
        <th colspan="3">HV Bushing</th>
        <th colspan="2">
          <%=
            min = [@bushing_test.health_index_factor("x1"), @bushing_test.health_index_factor("x2"),
                   @bushing_test.health_index_factor("x3"), @bushing_test.health_index_factor("x0")].min
            condition_color(min)
          %>
        </th>
        <tr>
          <th colspan="3">%LV Bushing Factor = </th>
          <th colspan="2">
            <%=
              max = [@bushing_test.percent_bushing_factor("x1"), @bushing_test.percent_bushing_factor("x2"),
                     @bushing_test.percent_bushing_factor("x3"), @bushing_test.percent_bushing_factor("x0")].max
              number_with_precision(max, :precision => 2)
            %>
          </th>
      </tr>
      <tr>
        <th>Bushing</th>
        <th>%Bushing Factor</th>
        <th>Health Index Factor</th>
        <th>Condition</th>
        <th>Date</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>X1</td>
        <td><%= number_with_precision(@bushing_test.percent_bushing_factor("x1"), precision: 2) %></td>
        <td><%= @bushing_test.health_index_factor("x1") %></td>
        <td><%= condition_color(@bushing_test.health_index_factor("y1")) %></td>
        <td><%= @bushing_test.thai_test_date %></td>
      </tr>
      <tr>
        <td>X3</td>
        <td><%= number_with_precision(@bushing_test.percent_bushing_factor("x2"), precision: 2) %></td>
        <td><%= @bushing_test.health_index_factor("x2") %></td>
        <td><%= condition_color(@bushing_test.health_index_factor("x2")) %></td>
        <td><%= @bushing_test.thai_test_date %></td>
      </tr>
      <tr>
        <td>X3</td>
        <td><%= number_with_precision(@bushing_test.percent_bushing_factor("x3"), precision: 2) %></td>
        <td><%= @bushing_test.health_index_factor("x3") %></td>
        <td><%= condition_color(@bushing_test.health_index_factor("x3")) %></td>
        <td><%= @bushing_test.thai_test_date %></td>
      </tr>
      <tr>
        <td>X0</td>
        <td><%= number_with_precision(@bushing_test.percent_bushing_factor("x0"), precision: 2) %></td>
        <td><%= @bushing_test.health_index_factor("x0") %></td>
        <td><%= condition_color(@bushing_test.health_index_factor("x0")) %></td>
        <td><%= @bushing_test.thai_test_date %></td>
      </tr>

    </tbody>
  </table>
</div>

<br/>
<hr>

<h4>กราฟแสดงความสัมพันธ์ระหว่าง %PowerFactor(C1) กับวันทดสอบ</h4>
<div id="xv_power_factor_cor_20c_graph" style="width:900px;height:400px"></div>
<button id="reset_xv_power_factor_cor_20c">Reset</button>

<br/>

<h4>กราฟแสดงความสัมพันธ์ระหว่าง %PowerFactor(C2) กับวันทดสอบ</h4>
<div id="xv_power_factor_avg_graph" style="width:900px;height:400px"></div>
<button id="reset_xv_power_factor_avg">Reset</button>

<br/>

<h4>กราฟแสดงความสัมพันธ์ระหว่าง %Capacitance(C1) กับวันทดสอบ</h4>
<div id="xv_c1_graph" style="width:900px;height:400px"></div>
<button id="reset_c1">Reset</button>

<br/>
<h4>กราฟแสดงความสัมพันธ์ระหว่าง %Capacitance(C2) กับวันทดสอบ</h4>
<div id="xv_c2_graph" style="width:900px;height:400px"></div>
<button id="reset_c2">Reset</button>

<hr/>
<br/>


<div class="grid_16">
  <table>
    <thead>
      <tr>
        <th colspan="3">HV Bushing</th>
        <th colspan="2">
          <%=
            min = [@bushing_test.health_index_factor("y1"), @bushing_test.health_index_factor("y2"),
                   @bushing_test.health_index_factor("y3")].min
            condition_color(min)
          %>
        </th>
        <tr>
          <th colspan="3">%HV Bushing Factor = </th>
          <th colspan="2">
            <%=
              max = [@bushing_test.percent_bushing_factor("y1"), @bushing_test.percent_bushing_factor("y2"),
                     @bushing_test.percent_bushing_factor("y3")].max
              number_with_precision(max, :precision => 2)
            %>
          </th>
      </tr>
      <tr>
        <th>Bushing</th>
        <th>%Bushing Factor</th>
        <th>Health Index Factor</th>
        <th>Condition</th>
        <th>Date</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>Y1</td>
        <td><%= number_with_precision(@bushing_test.percent_bushing_factor("y1"), precision: 2) %></td>
        <td><%= @bushing_test.health_index_factor("y1") %></td>
        <td><%= condition_color(@bushing_test.health_index_factor("y1")) %></td>
        <td><%= @bushing_test.thai_test_date %></td>
      </tr>
      <tr>
        <td>Y2</td>
        <td><%= number_with_precision(@bushing_test.percent_bushing_factor("y2"), precision: 2) %></td>
        <td><%= @bushing_test.health_index_factor("y2") %></td>
        <td><%= condition_color(@bushing_test.health_index_factor("y2")) %></td>
        <td><%= @bushing_test.thai_test_date %></td>
      </tr>
      <tr>
        <td>Y3</td>
        <td><%= number_with_precision(@bushing_test.percent_bushing_factor("y3"), precision: 2) %></td>
        <td><%= @bushing_test.health_index_factor("y3") %></td>
        <td><%= condition_color(@bushing_test.health_index_factor("y3")) %></td>
        <td><%= @bushing_test.thai_test_date %></td>
      </tr>
    </tbody>
  </table>
</div>
